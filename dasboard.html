<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="container">
        <h1 id="welcomeUser"></h1>
        <button onclick="logout()">Logout</button>

        <h2>Add Entry</h2>
        <form id="entryForm">
            Firm Name: <input type="text" id="firmName"><br>
            Location: <input type="text" id="location"><br>
            Years in Operation: <input type="text" id="years"><br>
            Description: <input type="text" id="description"><br>
            Contact Person: <input type="text" id="contactPerson"><br>
            Email: <input type="email" id="email"><br>
            Phone: <input type="text" id="phone"><br>
            <button type="button" onclick="addEntry()">Add Entry</button>
        </form>

        <h2>Entries</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Firm Name</th>
                    <th>Location</th>
                    <th>Years</th>
                    <th>Description</th>
                    <th>Contact Person</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody id="entriesTableBody"></tbody>
        </table>
    </div>

    <div class="container">
        <h2>Welcome, <span id="username"></span>!</h2>
        <p>Payment Status: <span id="paymentStatus">Pending</span></p>
        <button onclick="openPaymentOptions()">Make Payment</button>
        <p>You are now logged in.</p>
        <button onclick="logout()">Logout</button>

        <div id="paymentOptions" class="payment-container hidden">
            <h4>Select Duration</h4>
            <select id="durationSelect">
                <option value="647.36">10 Months - $647.36</option>
                <option value="500.00">7 Months - $500.00</option>
                <option value="350.00">5 Months - $350.00</option>
                <option value="210.00">3 Months - $210.00</option>
                <option value="100.00">1 Month - $100.00</option>
            </select>

            <h4>Select Payment Method</h4>
            <select id="paymentMethod" onchange="togglePaymentDetails()">
                <option value="Bank Transfer">Bank Transfer</option>
                <option value="Card">Card</option>
                <option value="Online Payment">Online Payment</option>
            </select>

            <div id="bankDetails" class="bank-details">
                <p>Account Number: 6312412879 <button onclick="copyAccount()">Copy</button></p>
                <p>Bank: Fidelity Bank</p>
                <p>Account Name: Hesed Agbadu Oghenakhwami</p>
            </div>

            <div id="cardDetails" class="card-details">
                <input type="text" id="cardNumber" placeholder="Card Number">
                <input type="text" id="expiryDate" placeholder="Expiration Date">
                <input type="text" id="cvv" placeholder="CVV">
            </div>

            <h4>Upload Proof of Transfer</h4>
            <input type="file" id="paymentProof">
            <button onclick="confirmPayment()">Submit Payment</button>
            <p id="paymentMessage"></p>
        </div>

        <h3>Your Entries</h3>
        <table>
            <thead>
                <tr>
                    <th>Firm Name</th>
                    <th>Contact Person</th>
                    <th>Nation</th>
                    <th>Phone</th>
                    <th>Payment Mode</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="dataList"></tbody>
        </table>

        <button onclick="submitForm()">Submit</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            loadUserData();
            displayEntries();
        });

        function loadUserData() {
            let currentUser = JSON.parse(localStorage.getItem("currentUser"));
            if (!currentUser) {
                window.location.href = "index.html";
                return;
            }
            document.getElementById("welcomeUser").innerText = `Welcome, ${currentUser.name}`;
        }

        function addEntry() {
            let firmName = document.getElementById("firmName").value.trim();
            let location = document.getElementById("location").value.trim();
            let years = document.getElementById("years").value.trim();
            let description = document.getElementById("description").value.trim();
            let contactPerson = document.getElementById("contactPerson").value.trim();
            let email = document.getElementById("email").value.trim();
            let phone = document.getElementById("phone").value.trim();

            if (!firmName || !location || !years || !description || !contactPerson || !email || !phone) {
                alert("Please fill all fields before submitting.");
                return;
            }

            let currentUser = JSON.parse(localStorage.getItem("currentUser"));
            let entries = JSON.parse(localStorage.getItem("entries")) || [];
            let newEntry = {
                id: entries.length + 1,
                firmName, location, years, description, contactPerson, email, phone,
                user: currentUser.email
            };

            entries.push(newEntry);
            localStorage.setItem("entries", JSON.stringify(entries));
            displayEntries();
            document.getElementById("entryForm").reset();
        }

        function confirmPayment() {
            const proof = document.getElementById('paymentProof').files[0];
            const paymentMethod = document.getElementById('paymentMethod').value;
            const paymentAmount = document.getElementById('durationSelect').value;

            if (paymentMethod === "Bank Transfer" && !proof) {
                alert('Please upload proof of payment!');
                return;
            }

            document.getElementById('paymentMessage').innerText = 'Your payment is under review';

            setTimeout(() => {
                document.getElementById('paymentMessage').innerText = 'Your payment has been confirmed âœ…';
                document.getElementById('paymentStatus').innerText = 'Paid';
                generateInvoice(paymentMethod, paymentAmount);
            }, 2000);
        }

        function generateInvoice(method, amount) {
            const invoiceContent = `
                Invoice\n
                Payment Method: ${method}\n
                Amount Paid: $${amount}\n
            `;

            const blob = new Blob([invoiceContent], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'Invoice.pdf';
            link.click();
        }

        function logout() {
            localStorage.removeItem("currentUser");
            window.location.href = "index.html";
        }
    </script>

</body>
</html>









